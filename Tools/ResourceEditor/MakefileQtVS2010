QT_DIR_OUTPUT := .GeneratedQt

QT_DIR_UI := DataQt
QT_DIR_QRC := DataQt
QT_DIR_MOC := Classes/Qt

QT_UI_FILES := $(wildcard $(QT_DIR_UI)/*.ui)
QT_UI_FILES_GEN := $(addprefix $(QT_DIR_OUTPUT)/ui_, $(notdir $(QT_UI_FILES:.ui=.h)))

QT_MOC_FILES := $(wildcard $(QT_DIR_MOC)/*.h) $(wildcard $(QT_DIR_MOC)/**/*.h)
QT_MOC_FILES_GEN := $(subst $(QT_DIR_MOC), $(QT_DIR_OUTPUT), $(QT_MOC_FILES:.h=_moc.cpp))

QT_MOC_FILES_ADDI := $(subst .needmeta, , $(wildcard $(QT_DIR_MOC)/*.needmeta) $(wildcard $(QT_DIR_MOC)/**/*.needmeta))
QT_MOC_FILES_GEN_ADDI := $(subst $(QT_DIR_MOC), $(QT_DIR_OUTPUT), $(QT_MOC_FILES_ADDI:.cpp=_moca.cpp))

QT_QRC_FILES := $(wildcard $(QT_DIR_QRC)/*.qrc) $(wildcard $(QT_DIR_QRC)/**/*.qrc)
QT_QRC_FILES_GEN := $(subst $(QT_DIR_QRC), $(QT_DIR_OUTPUT), $(QT_QRC_FILES:.qrc=_qrc.cpp))
                    

$(QT_DIR_OUTPUT):
	mkdir $(QT_DIR_OUTPUT)

$(QT_DIR_OUTPUT)/ui_%.h : $(QT_DIR_UI)/%.ui
	@echo $@
	@"$(QT_HOME)\Desktop\Qt\4.8.1\msvc2010\bin\uic.exe" $< -o $@

$(QT_DIR_OUTPUT)/%_moc.cpp : $(QT_DIR_MOC)/%.h
	@echo $@
	@mkdir "$(dir $@)"
	@"$(QT_HOME)\Desktop\Qt\4.8.1\msvc2010\bin\moc.exe" -DUNICODE -DWIN32 -D_MSC_VER=1600 -DQT_LARGEFILE_SUPPORT -DQT_DLL -DQT_GUI_LIB -DQT_CORE_LIB -DQT_HAVE_MMX -DQT_HAVE_3DNOW -DQT_HAVE_SSE -DQT_HAVE_MMXEXT -DQT_HAVE_SSE2 -DQT_THREAD_SUPPORT -I"$(QT_HOME)\Desktop\Qt\4.8.1\msvc2010\include\QtCore" -I"$(QT_HOME)\Desktop\Qt\4.8.1\msvc2010\include\QtGui" -I"$(QT_HOME)\Desktop\Qt\4.8.1\msvc2010\include" -I"$(QT_HOME)\Desktop\Qt\4.8.1\msvc2010\include\ActiveQt" -I"$(Configuration)" -I"." -I$(QT_HOME)\Desktop\Qt\4.8.1\msvc2010\mkspecs\default $< -o "$@"

$(QT_DIR_OUTPUT)/%_moca.cpp : $(QT_DIR_MOC)/%.cpp
	@echo $@
	@mkdir "$(dir $@)"
	@"$(QT_HOME)\Desktop\Qt\4.8.1\msvc2010\bin\moc.exe" -DUNICODE -DWIN32 -D_MSC_VER=1600 -DQT_LARGEFILE_SUPPORT -DQT_DLL -DQT_GUI_LIB -DQT_CORE_LIB -DQT_HAVE_MMX -DQT_HAVE_3DNOW -DQT_HAVE_SSE -DQT_HAVE_MMXEXT -DQT_HAVE_SSE2 -DQT_THREAD_SUPPORT -I"$(QT_HOME)\Desktop\Qt\4.8.1\msvc2010\include\QtCore" -I"$(QT_HOME)\Desktop\Qt\4.8.1\msvc2010\include\QtGui" -I"$(QT_HOME)\Desktop\Qt\4.8.1\msvc2010\include" -I"$(QT_HOME)\Desktop\Qt\4.8.1\msvc2010\include\ActiveQt" -I"$(Configuration)" -I"." -I$(QT_HOME)\Desktop\Qt\4.8.1\msvc2010\mkspecs\default $< -o "$@"

$(QT_DIR_OUTPUT)/%_qrc.cpp : $(QT_DIR_QRC)/%.qrc
	@echo $@
	@"$(QT_HOME)\Desktop\Qt\4.8.1\msvc2010\bin\rcc.exe" -name $(notdir $(basename $<)) $< -o $@

all: $(QT_DIR_OUTPUT) $(QT_UI_FILES_GEN) $(QT_MOC_FILES_GEN) $(QT_MOC_FILES_GEN_ADDI) $(QT_QRC_FILES_GEN)
